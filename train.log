2018-05-20 13:55:42,908 - brc - INFO - Running with args : Namespace(algo='MLSTM', batch_size=32, brc_dir='data/baidu', demo=False, dev_files=['data/demo/devset/search.dev.json', 'data/demo/devset/zhidao.dev.json'], dropout_keep_prob=1, embed_size=256, epochs=1000, evaluate=False, gpu='3', hidden_size=64, learning_rate=0.001, log_path=None, max_a_len=200, max_char_num=5, max_p_len=500, max_p_num=5, max_q_len=60, model_dir='data/models/', optim='adam', predict=False, prepare=False, result_dir='data/results/', summary_dir='data/summary/', test_files=['data/demo/testset/search.test.json', 'data/demo/testset/search.test.json'], train=True, train_files=['data/demo/trainset/search.train.json', 'data/demo/trainset/zhidao.train.json'], vocab_dir='data/vocab/', weight_decay=0)
2018-05-20 13:55:42,908 - brc - INFO - Load data_set and vocab...
2018-05-20 13:56:08,243 - brc - INFO - Train set size: 9403 questions.
2018-05-20 13:56:13,545 - brc - INFO - Dev set size: 2000 questions.
2018-05-20 13:56:13,545 - brc - INFO - Converting text into ids...
2018-05-20 13:56:58,888 - brc - INFO - Initialize the model...
2018-05-20 13:57:19,942 - brc - INFO - Time to build graph: 20.3992040157 s
2018-05-20 13:57:57,968 - brc - INFO - There are 30390849 parameters in the model
2018-05-20 13:58:02,674 - brc - INFO - Training the model...
2018-05-20 13:58:02,674 - brc - INFO - Training the model for epoch 1
2018-05-20 14:00:11,293 - brc - INFO - Average loss from batch 1 to 50 is 9.77886426926
2018-05-20 14:02:20,135 - brc - INFO - Average loss from batch 51 to 100 is 8.46656476974
2018-05-20 14:04:27,035 - brc - INFO - Average loss from batch 101 to 150 is 7.91005028725
2018-05-20 14:06:39,044 - brc - INFO - Average loss from batch 151 to 200 is 8.06212581635
2018-05-20 14:08:44,360 - brc - INFO - Average loss from batch 201 to 250 is 7.77788320541
2018-05-20 14:10:30,563 - brc - INFO - Average train loss for epoch 1 is 8.3002818346
2018-05-20 14:10:30,564 - brc - INFO - Evaluating the model after epoch 1
{'reflen': 164157, 'guess': [161834, 159951, 158073, 156202], 'testlen': 161834, 'correct': [79790, 54238, 44268, 39391]}
('ratio:', 0.9858489129309077)
2018-05-20 14:12:32,001 - brc - INFO - Dev eval loss 14.0343124542
2018-05-20 14:12:32,001 - brc - INFO - Dev eval result: {'Bleu-4': 0.3249380351337377, 'Rouge-L': 0.3566927206649968, 'Bleu-1': 0.4860094795563997, 'Bleu-3': 0.35528367036735414, 'Bleu-2': 0.4030544733048311}
2018-05-20 14:12:48,940 - brc - INFO - Model saved in data/models/, with prefix MLSTM.
2018-05-20 14:12:48,940 - brc - INFO - Training the model for epoch 2
